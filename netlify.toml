[build]
  # Ensure devDependencies (vite) are installed during CI by disabling npm's production mode
  command = "NPM_CONFIG_PRODUCTION=false npm ci && cd project && NPM_CONFIG_PRODUCTION=false npm ci && npm run build"
  functions = "netlify/functions"
  publish = "project/dist"

[context.production]
  # Same as above for production context
  command = "NPM_CONFIG_PRODUCTION=false npm ci && cd project && NPM_CONFIG_PRODUCTION=false npm ci && npm run build"

[context.develop]
  command = "cd project && npm run dev"

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/api:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
